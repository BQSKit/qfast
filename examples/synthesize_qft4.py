"""
Example showing how to synthesize a 4-qubit QFT program using QFAST.
"""

import numpy as np

from qfast import synthesize

# The 4-qubit QFT unitary matrix.
qft4 = np.array(
[[ 0.25             +0.j               ,  0.25             +0.j               ,
   0.25             +0.j               ,  0.25             +0.j               ,
   0.25             +0.j               ,  0.25             +0.j               ,
   0.25             +0.j               ,  0.25             +0.j               ,
   0.25             +0.j               ,  0.25             +0.j               ,
   0.25             +0.j               ,  0.25             +0.j               ,
   0.25             +0.j               ,  0.25             +0.j               ,
   0.25             +0.j               ,  0.25             +0.j               ],
 [ 0.25             +0.j               , -0.25             +0.j               ,
   0.25             +0.j               , -0.25             +0.j               ,
   0.25             +0.j               , -0.25             +0.j               ,
   0.25             +0.j               , -0.25             +0.j               ,
   0.25             +0.j               , -0.25             +0.j               ,
   0.25             +0.j               , -0.25             +0.j               ,
   0.25             +0.j               , -0.25             +0.j               ,
   0.25             +0.j               , -0.25             +0.j               ],
 [ 0.25             +0.j               ,  0.               +0.25j             ,
  -0.25             +0.j               ,  0.               -0.25j             ,
   0.25             +0.j               ,  0.               +0.25j             ,
  -0.25             +0.j               ,  0.               -0.25j             ,
   0.25             +0.j               ,  0.               +0.25j             ,
  -0.25             +0.j               ,  0.               -0.25j             ,
   0.25             +0.j               ,  0.               +0.25j             ,
  -0.25             +0.j               ,  0.               -0.25j             ],
 [ 0.25             +0.j               ,  0.               -0.25j             ,
  -0.25             +0.j               ,  0.               +0.25j             ,
   0.25             +0.j               ,  0.               -0.25j             ,
  -0.25             +0.j               ,  0.               +0.25j             ,
   0.25             +0.j               ,  0.               -0.25j             ,
  -0.25             +0.j               ,  0.               +0.25j             ,
   0.25             +0.j               ,  0.               -0.25j             ,
  -0.25             +0.j               ,  0.               +0.25j             ],
 [ 0.25             +0.j               ,  0.176776695296637+0.176776695296637j,
   0.               +0.25j             , -0.176776695296637+0.176776695296637j,
  -0.25             +0.j               , -0.176776695296637-0.176776695296637j,
   0.               -0.25j             ,  0.176776695296637-0.176776695296637j,
   0.25             +0.j               ,  0.176776695296637+0.176776695296637j,
   0.               +0.25j             , -0.176776695296637+0.176776695296637j,
  -0.25             +0.j               , -0.176776695296637-0.176776695296637j,
   0.               -0.25j             ,  0.176776695296637-0.176776695296637j],
 [ 0.25             +0.j               , -0.176776695296637-0.176776695296637j,
   0.               +0.25j             ,  0.176776695296637-0.176776695296637j,
  -0.25             +0.j               ,  0.176776695296637+0.176776695296637j,
   0.               -0.25j             , -0.176776695296637+0.176776695296637j,
   0.25             +0.j               , -0.176776695296637-0.176776695296637j,
   0.               +0.25j             ,  0.176776695296637-0.176776695296637j,
  -0.25             +0.j               ,  0.176776695296637+0.176776695296637j,
   0.               -0.25j             , -0.176776695296637+0.176776695296637j],
 [ 0.25             +0.j               , -0.176776695296637+0.176776695296637j,
   0.               -0.25j             ,  0.176776695296637+0.176776695296637j,
  -0.25             +0.j               ,  0.176776695296637-0.176776695296637j,
   0.               +0.25j             , -0.176776695296637-0.176776695296637j,
   0.25             +0.j               , -0.176776695296637+0.176776695296637j,
   0.               -0.25j             ,  0.176776695296637+0.176776695296636j,
  -0.25             +0.j               ,  0.176776695296637-0.176776695296637j,
   0.               +0.25j             , -0.176776695296637-0.176776695296636j],
 [ 0.25             +0.j               ,  0.176776695296637-0.176776695296637j,
   0.               -0.25j             , -0.176776695296637-0.176776695296637j,
  -0.25             +0.j               , -0.176776695296637+0.176776695296637j,
   0.               +0.25j             ,  0.176776695296637+0.176776695296637j,
   0.25             +0.j               ,  0.176776695296637-0.176776695296637j,
   0.               -0.25j             , -0.176776695296637-0.176776695296636j,
  -0.25             +0.j               , -0.176776695296637+0.176776695296637j,
   0.               +0.25j             ,  0.176776695296637+0.176776695296636j],
 [ 0.25             +0.j               ,  0.230969883127822+0.095670858091272j,
   0.176776695296637+0.176776695296637j,  0.095670858091273+0.230969883127822j,
   0.               +0.25j             , -0.095670858091272+0.230969883127822j,
  -0.176776695296637+0.176776695296637j, -0.230969883127821+0.095670858091273j,
  -0.25             +0.j               , -0.230969883127822-0.095670858091272j,
  -0.176776695296637-0.176776695296637j, -0.095670858091273-0.230969883127822j,
   0.               -0.25j             ,  0.095670858091272-0.230969883127822j,
   0.176776695296637-0.176776695296637j,  0.230969883127822-0.095670858091273j],
 [ 0.25             +0.j               , -0.230969883127822-0.095670858091272j,
   0.176776695296637+0.176776695296637j, -0.095670858091273-0.230969883127822j,
   0.               +0.25j             ,  0.095670858091272-0.230969883127822j,
  -0.176776695296637+0.176776695296637j,  0.230969883127821-0.095670858091273j,
  -0.25             +0.j               ,  0.230969883127822+0.095670858091272j,
  -0.176776695296637-0.176776695296637j,  0.095670858091273+0.230969883127822j,
   0.               -0.25j             , -0.095670858091272+0.230969883127822j,
   0.176776695296637-0.176776695296637j, -0.230969883127822+0.095670858091273j],
 [ 0.25             +0.j               , -0.095670858091272+0.230969883127822j,
  -0.176776695296637-0.176776695296637j,  0.230969883127821-0.095670858091273j,
   0.               +0.25j             , -0.230969883127822-0.095670858091272j,
   0.176776695296637-0.176776695296637j,  0.095670858091273+0.230969883127821j,
  -0.25             +0.j               ,  0.095670858091272-0.230969883127822j,
   0.176776695296637+0.176776695296637j, -0.230969883127822+0.095670858091273j,
   0.               -0.25j             ,  0.230969883127822+0.095670858091272j,
  -0.176776695296637+0.176776695296637j, -0.095670858091273-0.230969883127821j],
 [ 0.25             +0.j               ,  0.095670858091272-0.230969883127822j,
  -0.176776695296637-0.176776695296637j, -0.230969883127821+0.095670858091273j,
   0.               +0.25j             ,  0.230969883127822+0.095670858091272j,
   0.176776695296637-0.176776695296637j, -0.095670858091273-0.230969883127821j,
  -0.25             +0.j               , -0.095670858091272+0.230969883127822j,
   0.176776695296637+0.176776695296637j,  0.230969883127822-0.095670858091273j,
   0.               -0.25j             , -0.230969883127822-0.095670858091272j,
  -0.176776695296637+0.176776695296637j,  0.095670858091273+0.230969883127821j],
 [ 0.25             +0.j               ,  0.095670858091273+0.230969883127822j,
  -0.176776695296637+0.176776695296637j, -0.230969883127822-0.095670858091272j,
   0.               -0.25j             ,  0.230969883127821-0.095670858091273j,
   0.176776695296637+0.176776695296637j, -0.095670858091272+0.230969883127822j,
  -0.25             +0.j               , -0.095670858091273-0.230969883127822j,
   0.176776695296637-0.176776695296637j,  0.230969883127822+0.095670858091272j,
   0.               +0.25j             , -0.230969883127822+0.095670858091273j,
  -0.176776695296637-0.176776695296637j,  0.095670858091272-0.230969883127822j],
 [ 0.25             +0.j               , -0.095670858091273-0.230969883127822j,
  -0.176776695296637+0.176776695296637j,  0.230969883127822+0.095670858091272j,
   0.               -0.25j             , -0.230969883127822+0.095670858091273j,
   0.176776695296637+0.176776695296636j,  0.095670858091272-0.230969883127822j,
  -0.25             +0.j               ,  0.095670858091273+0.230969883127822j,
   0.176776695296637-0.176776695296637j, -0.230969883127822-0.095670858091272j,
   0.               +0.25j             ,  0.230969883127822-0.095670858091273j,
  -0.176776695296637-0.176776695296637j, -0.095670858091272+0.230969883127822j],
 [ 0.25             +0.j               , -0.230969883127821+0.095670858091273j,
   0.176776695296637-0.176776695296637j, -0.095670858091272+0.230969883127822j,
   0.               -0.25j             ,  0.095670858091273+0.230969883127821j,
  -0.176776695296637-0.176776695296637j,  0.230969883127822+0.095670858091272j,
  -0.25             +0.j               ,  0.230969883127821-0.095670858091273j,
  -0.176776695296637+0.176776695296637j,  0.095670858091272-0.230969883127822j,
   0.               +0.25j             , -0.095670858091273-0.230969883127821j,
   0.176776695296637+0.176776695296637j, -0.230969883127822-0.095670858091272j],
 [ 0.25             +0.j               ,  0.230969883127822-0.095670858091273j,
   0.176776695296637-0.176776695296637j,  0.095670858091272-0.230969883127822j,
   0.               -0.25j             , -0.095670858091273-0.230969883127821j,
  -0.176776695296637-0.176776695296637j, -0.230969883127822-0.095670858091272j,
  -0.25             +0.j               , -0.230969883127822+0.095670858091273j,
  -0.176776695296637+0.176776695296637j, -0.095670858091272+0.230969883127822j,
   0.               +0.25j             ,  0.095670858091273+0.230969883127821j,
   0.176776695296637+0.176776695296637j,  0.230969883127822+0.095670858091272j]]
)

# # Enable Logging
# import logging
# logging.getLogger( "qfast" ).setLevel( logging.DEBUG )

# Synthesize the qft4 unitary and print results
print( synthesize( qft4 ) )
